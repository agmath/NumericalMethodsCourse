<!DOCTYPE html>
<html lang="en"><head>
<script src="D11_LeastSquares_files/libs/clipboard/clipboard.min.js"></script>
<script src="D11_LeastSquares_files/libs/quarto-html/tabby.min.js"></script>
<script src="D11_LeastSquares_files/libs/quarto-html/popper.min.js"></script>
<script src="D11_LeastSquares_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="D11_LeastSquares_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="D11_LeastSquares_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="D11_LeastSquares_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="D11_LeastSquares_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.5.43">

  <meta name="author" content="Dr.&nbsp;Gilbert">
  <meta name="dcterms.date" content="2026-02-20">
  <title>MAT 370: Least Squares Regression</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="D11_LeastSquares_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="D11_LeastSquares_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="D11_LeastSquares_files/libs/revealjs/dist/theme/quarto.css">
  <link href="D11_LeastSquares_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="D11_LeastSquares_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="D11_LeastSquares_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="D11_LeastSquares_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">MAT 370: Least Squares Regression</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Dr.&nbsp;Gilbert 
</div>
</div>
</div>

  <p class="date">February 20, 2026</p>
</section>
<section class="slide level2">

<div class="cell">
<style type="text/css">
code.sourceCode {
  font-size: 1.3em;
  /* or try font-size: xx-large; */
}

a {
  color: purple;
}

a:link {
  color: purple;
}

a:visited {
  color: purple;
}
</style>
</div>
</section>
<section id="motivation-and-context" class="slide level2">
<h2>Motivation and Context</h2>
<div style="font-size:18pt">
<div class="fragment">
<p>Often we must recognize that relationships are neither deterministic nor causal.</p>
</div>
<div class="fragment">
<p>Noisy associations exist between one or more independent variables and a response.</p>
</div>
<div class="fragment">
<p>In these cases, building an interpolant doesn’t make sense. Instead, we want to capture a general trend.</p>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<div class="fragment">
<center>
<strong>Interpolant</strong>
</center>
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="D11_LeastSquares_files/figure-revealjs/unnamed-chunk-3-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="fragment">
<center>
<strong>Least Squares Fit</strong>
</center>
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="D11_LeastSquares_files/figure-revealjs/unnamed-chunk-4-3.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="fragment">
<p>The interpolant is doing exactly what its designed to do – pass through every observed data point exactly, but that forces unsupported variability (even with using a cubic spline interpolant). We probably don’t realistically expect new data to follow the interpolant – the model on the right is more conservative, but likely more trustworthy.</p>
</div>
</div>
</section>
<section id="overview" class="slide level2">
<h2>Overview</h2>
<div style="font-size:18pt">
<div class="fragment">
<p>With admittedly noisy data and noisy relationships, we want to build a model that captures a general trend between the availabile independent variables and our response.</p>
</div>
<div class="fragment">
<p>That model should have a fairly simple form, otherwise we risk fitting the noise, which is unpredictable by definition.</p>
</div>
<div class="fragment">
<p>Consider a function <span class="math inline">\(f\left(x\right) = f\left(x\mid \beta_0, \beta_1,\cdots,\beta_m\right)\)</span> which has been fitted using <span class="math inline">\(n+1\)</span> observed data points of the form <span class="math inline">\(\left(\vec{x}_i, y_i\right)\)</span>.</p>
</div>
<div class="fragment">
<p>This function includes <span class="math inline">\(m+1\)</span> parameters (<span class="math inline">\(\beta_0, \cdots, \beta_m\)</span>), so <span class="math inline">\(m+1 \leq n+1\)</span>.</p>
</div>
<div class="fragment">
<p>The observed points <span class="math inline">\(\left(\vec{x}_i, y_i\right)\)</span> consist of measurements on independent variables which are contained in <span class="math inline">\(\vec{x}_i\)</span> and a corresponding measured dependent response contained in <span class="math inline">\(y_i\)</span>.</p>
</div>
<ul>
<li class="fragment"><p>Note that <span class="math inline">\(\vec{x}_i\)</span> may consist of a single measured variable or many.</p></li>
<li class="fragment"><p>For example, if the data represent the <em>displacements</em> <span class="math inline">\(y_i\)</span> of an overdamped mass-spring system at time <span class="math inline">\(t\)</span>, then the observations are of the form <span class="math inline">\(\left(t_i, y_i\right)\)</span> and the form of the model suggested by theory is <span class="math inline">\(\displaystyle{f\left(t\right) = a_0te^{-a_1t}}\)</span>.</p>
<ul>
<li class="fragment">The parameters <span class="math inline">\(a_0\)</span> and <span class="math inline">\(a_1\)</span> for the model are to be <em>learned</em> from the observed data (these take the place of the <span class="math inline">\(\beta\)</span>s referenced above).</li>
</ul></li>
</ul>
</div>
</section>
<section id="fitting-learning-parameters-intuition" class="slide level2">
<h2>Fitting / Learning Parameters (Intuition)</h2>
<div class="fragment">
<div style="font-size:20pt">
<p>In general, parameters for a fitted model are obtained by minimizing a <em>loss function</em>.</p>
</div>
</div>
<div class="fragment">
<div style="font-size:20pt">
<p>If we are willing to assume that the <em>noise</em> is a feature of the response variable only (and the measurements on the independent variable(s) are to be trusted), then the most common loss function is the <em>Sum of Squared Errors</em>:</p>
</div>
</div>
<div class="fragment">
<div style="font-size:18pt">
<p><span class="math display">\[L\left(\beta_0, \beta_1,\cdots,\beta_m\right) = \sum_{i=0}^{n}{\left[y_i - f\left(x_i\right)\right]^2}\]</span></p>
</div>
</div>
<div class="fragment">
<div style="font-size:20pt">
<p>Models fit by minimizing the loss function above are said to be fit using <em>Ordinary Least Squares</em> (OLS).</p>
</div>
</div>
</section>
<section id="fitting-learning-parameters-mechanics" class="slide level2">
<h2>Fitting / Learning Parameters (Mechanics)</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="fragment">
<div style="font-size:18pt">
<p>The values of the <span class="math inline">\(\beta\)</span>-parameters minimizing any Loss Function will satisfy the simultaneous system:</p>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="fragment">
<div style="font-size:16pt">
<p><span class="math display">\[\left\{\frac{\partial L}{\partial \beta_j} = 0,~~\text{for}~~ j = 0, 1,\cdots, m\right.\]</span></p>
</div>
</div>
</div>
</div>
<div style="font-size:18pt">
<div class="fragment">
<p>Depending on the form of the model <span class="math inline">\(f\left(x\right)\)</span> the equations in the system above may be non-linear and difficult to solve.</p>
</div>
<div class="fragment">
<p>It is common to choose <span class="math inline">\(f\left(x\right)\)</span> to be a <em>linear combination</em> of <em>base functions</em> <span class="math inline">\(f_i\left(x\right)\)</span> so that</p>
<p><span class="math display">\[f\left(x\right) = \beta_0f_0\left(x\right) + \beta_1f_1\left(x\right) + \cdots + \beta_mf_m\left(x\right)\]</span></p>
</div>
<div class="fragment">
<p>Doing this forces the simultaneous system to be linear in the <span class="math inline">\(\beta_i\)</span> values.</p>
</div>
<div class="fragment">
<p>As an example, if the fitted function is to be a polynomial, then we have <span class="math inline">\(f_0\left(x\right) = 1\)</span>, <span class="math inline">\(f_1\left(x\right) = x\)</span>, <span class="math inline">\(f_2\left(x\right) = x^2\)</span>, and so on. Resulting in</p>
</div>
<div class="fragment">
<p><span class="math display">\[f\left(x\right) = \beta_0 + \beta_1x + \beta_2x^2 + \cdots + \beta_mx^m\]</span></p>
</div>
</div>
</section>
<section id="measuring-error" class="slide level2">
<h2>Measuring Error</h2>
<div class="fragment">
<p>Because we seek to capture a general trend, we know that the fitted model will not pass through all of the observed data points.</p>
</div>
<div class="fragment">
<p>We can define the standard error of the model residuals (prediction errors) to be</p>
<p><span class="math display">\[s_E = \sqrt{\left(\frac{L}{n - m}\right)}\]</span></p>
<p>where <span class="math inline">\(L\)</span> denotes the loss of the fitted function over all the observed data.</p>
</div>
<div class="fragment">
<p>If <span class="math inline">\(n+1 = m+1\)</span> (if there is a parameter for every observation) then the model is an interpolant and the <span class="math inline">\(s_E\)</span> is undefined since it takes a “zero over zero” form.</p>
</div>
</section>
<section id="fitting-a-straight-line-model" class="slide level2">
<h2>Fitting a Straight-Line Model</h2>
<div class="fragment" data-fragment-index="1">
<div style="font-size:17pt">
<p>A simple linear regression model is a model of the form <span class="math inline">\(f\left(x\right) = \beta_0 + \beta_1x\)</span> which is fit to observed data of the form <span class="math inline">\(\left(x_i, y_i\right)\)</span> by minimizing the sum of squared residuals.</p>
</div>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<div class="fragment" data-fragment-index="2">
<div style="font-size:17pt">
<p>In this case we can analyze our Loss function as follows:</p>
</div>
</div>
<div class="fragment" data-fragment-index="3">
<div style="font-size:16pt">
<p><span class="math display">\[\begin{align*} L\left(\beta_0, \beta_1\right) &amp;= \sum_{i = 0}^{n}{\left[y_i - f\left(x_i\right)\right]^2}
\end{align*}\]</span></p>
</div>
</div>
</div><div class="column" style="width:50%;">

</div>
</div>
</section>
<section id="fitting-a-straight-line-model-1" class="slide level2">
<h2>Fitting a Straight-Line Model</h2>
<div style="font-size:17pt">
<p>A simple linear regression model is a model of the form <span class="math inline">\(f\left(x\right) = \beta_0 + \beta_1x\)</span> which is fit to observed data of the form <span class="math inline">\(\left(x_i, y_i\right)\)</span> by minimizing the sum of squared residuals.</p>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<div style="font-size:17pt">
<p>In this case we can analyze our Loss function as follows:</p>
</div>
<div style="font-size:16pt">
<p><span class="math display">\[\begin{align*} L\left(\beta_0, \beta_1\right) &amp;= \sum_{i = 0}^{n}{\left[y_i - f\left(x_i\right)\right]^2}\\
&amp;= \sum_{i = 0}^{n}{\left[y_i - \beta_0 - \beta_1x_i\right]^2}
\end{align*}\]</span></p>
</div>
<div class="fragment" data-fragment-index="1">
<div style="font-size:17pt">
<p>We can minimize <span class="math inline">\(L\left(\beta_0, \beta_1\right)\)</span> by solving the system:</p>
</div>
<div style="font-size:16pt">
<p><span class="math display">\[\left\{\begin{array}{lcl} \frac{\partial L}{\partial \beta_0} &amp; = &amp; 0\\
\frac{\partial L}{\partial \beta_1} &amp; = &amp; 0\end{array}\right.\]</span></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="fragment" data-fragment-index="2">
<div style="font-size:18pt">
<p><span class="math display">\[\implies \left\{\begin{array}{lcl} \sum{-2\left(y_i - \beta_0 - \beta_1x_i\right)} &amp; = &amp; 0\\
\sum{-2x_i\left(y_i - \beta_0 - \beta_1x_i\right)} &amp; = &amp; 0\end{array}\right.\]</span></p>
</div>
</div>
</div>
</div>
</section>
<section id="fitting-a-straight-line-model-2" class="slide level2">
<h2>Fitting a Straight-Line Model</h2>
<div style="font-size:17pt">
<p>A simple linear regression model is a model of the form <span class="math inline">\(f\left(x\right) = \beta_0 + \beta_1x\)</span> which is fit to observed data of the form <span class="math inline">\(\left(x_i, y_i\right)\)</span> by minimizing the sum of squared residuals.</p>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<div style="font-size:17pt">
<p>In this case we can analyze our Loss function as follows:</p>
</div>
<div style="font-size:16pt">
<p><span class="math display">\[\begin{align*} L\left(\beta_0, \beta_1\right) &amp;= \sum_{i = 0}^{n}{\left[y_i - f\left(x_i\right)\right]^2}\\
&amp;= \sum_{i = 0}^{n}{\left[y_i - \beta_0 - \beta_1x_i\right]^2}
\end{align*}\]</span></p>
</div>
<div style="font-size:17pt">
<p>We can minimize <span class="math inline">\(L\left(\beta_0, \beta_1\right)\)</span> by solving the system:</p>
</div>
<div style="font-size:16pt">
<p><span class="math display">\[\left\{\begin{array}{lcl} \frac{\partial L}{\partial \beta_0} &amp; = &amp; 0\\
\frac{\partial L}{\partial \beta_1} &amp; = &amp; 0\end{array}\right.\]</span></p>
</div>
</div><div class="column" style="width:50%;">
<div style="font-size:18pt">
<p><span class="math display">\[\implies \left\{\begin{array}{lcl} \sum{-2\left(y_i - \beta_0 - \beta_1x_i\right)} &amp; = &amp; 0\\
\sum{-2x_i\left(y_i - \beta_0 - \beta_1x_i\right)} &amp; = &amp; 0\end{array}\right.\]</span> <span class="math display">\[\implies \left\{\begin{array}{lcl} \sum{\left(y_i - \beta_0 - \beta_1x_i\right)} &amp; = &amp; 0\\
\sum{\left(x_iy_i - \beta_0x_i - \beta_1x_i^2\right)} &amp; = &amp; 0\end{array}\right.\]</span></p>
</div>
</div>
</div>
</section>
<section id="fitting-a-straight-line-model-3" class="slide level2">
<h2>Fitting a Straight-Line Model</h2>
<div style="font-size:17pt">
<p>A simple linear regression model is a model of the form <span class="math inline">\(f\left(x\right) = \beta_0 + \beta_1x\)</span> which is fit to observed data of the form <span class="math inline">\(\left(x_i, y_i\right)\)</span> by minimizing the sum of squared residuals.</p>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<div style="font-size:17pt">
<p>In this case we can analyze our Loss function as follows:</p>
</div>
<div style="font-size:16pt">
<p><span class="math display">\[\begin{align*} L\left(\beta_0, \beta_1\right) &amp;= \sum_{i = 0}^{n}{\left[y_i - f\left(x_i\right)\right]^2}\\
&amp;= \sum_{i = 0}^{n}{\left[y_i - \beta_0 - \beta_1x_i\right]^2}
\end{align*}\]</span></p>
</div>
<div style="font-size:17pt">
<p>We can minimize <span class="math inline">\(L\left(\beta_0, \beta_1\right)\)</span> by solving the system:</p>
</div>
<div style="font-size:16pt">
<p><span class="math display">\[\left\{\begin{array}{lcl} \frac{\partial L}{\partial \beta_0} &amp; = &amp; 0\\
\frac{\partial L}{\partial \beta_1} &amp; = &amp; 0\end{array}\right.\]</span></p>
</div>
</div><div class="column" style="width:50%;">
<div style="font-size:18pt">
<p><span class="math display">\[\implies \left\{\begin{array}{lcl} \sum{-2\left(y_i - \beta_0 - \beta_1x_i\right)} &amp; = &amp; 0\\
\sum{-2x_i\left(y_i - \beta_0 - \beta_1x_i\right)} &amp; = &amp; 0\end{array}\right.\]</span> <span class="math display">\[\implies \left\{\begin{array}{lcl} \sum{\left(y_i - \beta_0 - \beta_1x_i\right)} &amp; = &amp; 0\\
\sum{\left(x_iy_i - \beta_0x_i - \beta_1x_i^2\right)} &amp; = &amp; 0\end{array}\right.\]</span> <span class="math display">\[\implies \left\{\begin{array}{lcl} \sum{\left(\frac{y_i}{n+1} - \frac{\beta_0}{n+1} - \frac{\beta_1x_i}{n+1}\right)} &amp; = &amp; 0\\
\sum{\left(\frac{x_iy_i}{n+1} - \frac{\beta_0x_i}{n+1} - \frac{\beta_1x_i^2}{n+1}\right)} &amp; = &amp; 0\end{array}\right.\]</span></p>
</div>
</div>
</div>
</section>
<section id="fitting-a-straight-line-model-4" class="slide level2">
<h2>Fitting a Straight-Line Model</h2>
<div style="font-size:17pt">
<p>A simple linear regression model is a model of the form <span class="math inline">\(f\left(x\right) = \beta_0 + \beta_1x\)</span> which is fit to observed data of the form <span class="math inline">\(\left(x_i, y_i\right)\)</span> by minimizing the sum of squared residuals.</p>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<div style="font-size:17pt">
<p>In this case we can analyze our Loss function as follows:</p>
</div>
<div style="font-size:16pt">
<p><span class="math display">\[\begin{align*} L\left(\beta_0, \beta_1\right) &amp;= \sum_{i = 0}^{n}{\left[y_i - f\left(x_i\right)\right]^2}\\
&amp;= \sum_{i = 0}^{n}{\left[y_i - \beta_0 - \beta_1x_i\right]^2}
\end{align*}\]</span></p>
</div>
<div style="font-size:17pt">
<p>We can minimize <span class="math inline">\(L\left(\beta_0, \beta_1\right)\)</span> by solving the system:</p>
</div>
<div style="font-size:16pt">
<p><span class="math display">\[\left\{\begin{array}{lcl} \frac{\partial L}{\partial \beta_0} &amp; = &amp; 0\\
\frac{\partial L}{\partial \beta_1} &amp; = &amp; 0\end{array}\right.\]</span></p>
</div>
<div style="font-size:17pt">
<div class="fragment" data-fragment-index="1">
<p>The top equation in the last line to the right indicates that <span class="math inline">\(\beta_0 = \bar{y} - \beta_1\bar{x}\)</span>.</p>
</div>
</div>
</div><div class="column" style="width:50%;">
<div style="font-size:18pt">
<p><span class="math display">\[\implies \left\{\begin{array}{lcl} \sum{-2\left(y_i - \beta_0 - \beta_1x_i\right)} &amp; = &amp; 0\\
\sum{-2x_i\left(y_i - \beta_0 - \beta_1x_i\right)} &amp; = &amp; 0\end{array}\right.\]</span> <span class="math display">\[\implies \left\{\begin{array}{lcl} \sum{\left(y_i - \beta_0 - \beta_1x_i\right)} &amp; = &amp; 0\\
\sum{\left(x_iy_i - \beta_0x_i - \beta_1x_i^2\right)} &amp; = &amp; 0\end{array}\right.\]</span> <span class="math display">\[\implies \left\{\begin{array}{lcl} \sum{\left(\frac{y_i}{n+1} - \frac{\beta_0}{n+1} - \frac{\beta_1x_i}{n+1}\right)} &amp; = &amp; 0\\
\sum{\left(\frac{x_iy_i}{n+1} - \frac{\beta_0x_i}{n+1} - \frac{\beta_1x_i^2}{n+1}\right)} &amp; = &amp; 0\end{array}\right.\]</span> <span class="math display">\[\implies \left\{\begin{array}{lcl} \bar{y} - \beta_0 - \beta_1\bar{x} &amp; = &amp; 0\\
- \beta_0\bar{x} + \sum{\left(\frac{x_iy_i}{n+1} - \frac{\beta_1x_i^2}{n+1}\right)} &amp; = &amp; 0\end{array}\right.\]</span></p>
</div>
</div>
</div>
<div style="font-size:17pt">
<div class="fragment" data-fragment-index="2">
<p>We can substitute this into the bottom equation and use some algebra to arrive at <span class="math inline">\(\displaystyle{\beta_1 = \frac{\sum{y_i\left(x_i - \bar{x}\right)}}{\sum{x_i\left(x_i - \bar{x}\right)}}}\)</span>. (<span class="math inline">\(\bigstar\)</span> – the algebra required is included at the end of this slide deck for those interested)</p>
</div>
</div>
</section>
<section id="fitting-general-linear-forms" class="slide level2">
<h2>Fitting General Linear Forms</h2>
<div class="fragment">
<div style="font-size:18pt">
<p>Consider the least-squares fit</p>
</div>
<div style="font-size:16pt">
<p><span class="math display">\[\begin{align*}f\left(x\right) &amp;= \beta_0f_0\left(x\right) + \beta_1f_1\left(x\right) + \beta_2f_2\left(x\right) + \cdots + \beta_mf_m\left(x\right)\\
&amp;= \sum_{j=0}^{m}{\beta_j f_j\left(x\right)}
\end{align*}\]</span></p>
</div>
</div>
<div class="fragment">
<div style="font-size:18pt">
<p>Substituting this into our <em>least squares loss function</em> gives</p>
</div>
<div style="font-size:16pt">
<p><span class="math display">\[L\left(\beta_0, \beta_1, \cdots, \beta_m\right) = \sum_{i=0}^{n}\left[y_i - \sum_{j=0}^{m}{\beta_j f_j\left(x_i\right)}\right]^2\]</span></p>
</div>
</div>
<div class="fragment">
<div style="font-size:18pt">
<p>Which is minimized by the solution to the following linear system:</p>
</div>
<div style="font-size:16pt">
<p><span class="math display">\[\left\{\frac{\partial L}{\partial \beta_k} = -2\left(\sum_{i=0}^{n}{\left(\left(y_i - \sum_{j = 0}^{m}{\left(\beta_j f_j\left(x_i\right)\right)}\right)f_k\left(x_i\right)\right)}\right) = 0\right.~~\text{for}~~k = 0, 1, \cdots, m\]</span></p>
</div>
</div>
</section>
<section id="minimizing-the-loss" class="slide level2">
<h2>Minimizing the Loss</h2>
<div class="fragment">
<div style="font-size:18pt">
<p>As a reminder, we are minimizing</p>
</div>
<div style="font-size:16pt">
<p><span class="math display">\[\left\{\frac{\partial L}{\partial \beta_k} = -2\left(\sum_{i=0}^{n}{\left(\left(y_i - \sum_{j = 0}^{m}{\left(\beta_j f_j\left(x_i\right)\right)}\right)f_k\left(x_i\right)\right)}\right) = 0\right.~~\text{for}~~k = 0, 1, \cdots, m\]</span></p>
</div>
</div>
<div class="fragment">
<div style="font-size:18pt">
<p>We can divide both sides of each equation in the system by <span class="math inline">\(-2\)</span> and rearrange the summations.</p>
</div>
<div class="columns">
<div class="column" style="width:45%;">
<div style="font-size:16pt">
<p><span class="math display">\[\begin{align*}\left\{\left(\sum_{i=0}^{n}{\left(\left(y_i - \sum_{j = 0}^{m}{\left(\beta_j f_j\left(x_i\right)\right)}\right)f_k\left(x_i\right)\right)}\right)\right. &amp;= 0
\end{align*}\]</span></p>
</div>
</div><div class="column" style="width:5%;">
<div style="height:100%; border-right:3px solid #444;">

</div>
</div><div class="column" style="width:5%;">
<div style="height:100%; border-left:3px solid #444;">

</div>
</div><div class="column" style="width:45%;">

</div>
</div>
</div>
</section>
<section id="minimizing-the-loss-1" class="slide level2">
<h2>Minimizing the Loss</h2>
<div style="font-size:18pt">
<p>As a reminder, we are minimizing</p>
</div>
<div style="font-size:16pt">
<p><span class="math display">\[\left\{\frac{\partial L}{\partial \beta_k} = -2\left(\sum_{i=0}^{n}{\left(\left(y_i - \sum_{j = 0}^{m}{\left(\beta_j f_j\left(x_i\right)\right)}\right)f_k\left(x_i\right)\right)}\right) = 0\right.~~\text{for}~~k = 0, 1, \cdots, m\]</span></p>
</div>
<div style="font-size:18pt">
<p>We can divide both sides of each equation in the system by <span class="math inline">\(-2\)</span> and rearrange the summations.</p>
</div>
<div class="columns">
<div class="column" style="width:45%;">
<div style="font-size:16pt">
<p><span class="math display">\[\begin{align*}\left\{\left(\sum_{i=0}^{n}{\left(\left(y_i - \sum_{j = 0}^{m}{\left(\beta_j f_j\left(x_i\right)\right)}\right)f_k\left(x_i\right)\right)}\right)\right. &amp;= 0\\
\implies \left\{\sum_{i=0}^{n}{\left(y_if_k\left(x_i\right) - \sum_{j = 0}^{m}{\left(\beta_j f_j\left(x_i\right)f_k\left(x_i\right)\right)}\right)}\right. &amp;= 0
\end{align*}\]</span></p>
</div>
</div><div class="column" style="width:5%;">
<div style="height:100%; border-right:3px solid #444;">

</div>
</div><div class="column" style="width:5%;">
<div style="height:100%; border-left:3px solid #444;">

</div>
</div><div class="column" style="width:45%;">

</div>
</div>
</section>
<section id="minimizing-the-loss-2" class="slide level2">
<h2>Minimizing the Loss</h2>
<div style="font-size:18pt">
<p>As a reminder, we are minimizing</p>
</div>
<div style="font-size:16pt">
<p><span class="math display">\[\left\{\frac{\partial L}{\partial \beta_k} = -2\left(\sum_{i=0}^{n}{\left(\left(y_i - \sum_{j = 0}^{m}{\left(\beta_j f_j\left(x_i\right)\right)}\right)f_k\left(x_i\right)\right)}\right) = 0\right.~~\text{for}~~k = 0, 1, \cdots, m\]</span></p>
</div>
<div style="font-size:18pt">
<p>We can divide both sides of each equation in the system by <span class="math inline">\(-2\)</span> and rearrange the summations.</p>
</div>
<div class="columns">
<div class="column" style="width:45%;">
<div style="font-size:16pt">
<p><span class="math display">\[\begin{align*}\left\{\left(\sum_{i=0}^{n}{\left(\left(y_i - \sum_{j = 0}^{m}{\left(\beta_j f_j\left(x_i\right)\right)}\right)f_k\left(x_i\right)\right)}\right)\right. &amp;= 0\\
\implies \left\{\sum_{i=0}^{n}{\left(y_if_k\left(x_i\right) - \sum_{j = 0}^{m}{\left(\beta_j f_j\left(x_i\right)f_k\left(x_i\right)\right)}\right)}\right. &amp;= 0\\
\implies \left\{\sum_{i=0}^{n}{\left(y_if_k\left(x_i\right)\right)} - \sum_{i=0}^{n}{\left(\sum_{j = 0}^{m}{\left(\beta_j f_j\left(x_i\right)f_k\left(x_i\right)\right)}\right)}\right. &amp;= 0
\end{align*}\]</span></p>
</div>
</div><div class="column" style="width:5%;">
<div style="height:100%; border-right:3px solid #444;">

</div>
</div><div class="column" style="width:5%;">
<div style="height:100%; border-left:3px solid #444;">

</div>
</div><div class="column" style="width:45%;">

</div>
</div>
</section>
<section id="minimizing-the-loss-3" class="slide level2">
<h2>Minimizing the Loss</h2>
<div style="font-size:18pt">
<p>As a reminder, we are minimizing</p>
</div>
<div style="font-size:16pt">
<p><span class="math display">\[\left\{\frac{\partial L}{\partial \beta_k} = -2\left(\sum_{i=0}^{n}{\left(\left(y_i - \sum_{j = 0}^{m}{\left(\beta_j f_j\left(x_i\right)\right)}\right)f_k\left(x_i\right)\right)}\right) = 0\right.~~\text{for}~~k = 0, 1, \cdots, m\]</span></p>
</div>
<div style="font-size:18pt">
<p>We can divide both sides of each equation in the system by <span class="math inline">\(-2\)</span> and rearrange the summations.</p>
</div>
<div class="columns">
<div class="column" style="width:45%;">
<div style="font-size:16pt">
<p><span class="math display">\[\begin{align*}\left\{\left(\sum_{i=0}^{n}{\left(\left(y_i - \sum_{j = 0}^{m}{\left(\beta_j f_j\left(x_i\right)\right)}\right)f_k\left(x_i\right)\right)}\right)\right. &amp;= 0\\
\implies \left\{\sum_{i=0}^{n}{\left(y_if_k\left(x_i\right) - \sum_{j = 0}^{m}{\left(\beta_j f_j\left(x_i\right)f_k\left(x_i\right)\right)}\right)}\right. &amp;= 0\\
\implies \left\{\sum_{i=0}^{n}{\left(y_if_k\left(x_i\right)\right)} - \sum_{i=0}^{n}{\left(\sum_{j = 0}^{m}{\left(\beta_j f_j\left(x_i\right)f_k\left(x_i\right)\right)}\right)}\right. &amp;= 0\\
\implies \left\{\sum_{i=0}^{n}{\left(\sum_{j = 0}^{m}{\left(\beta_j f_j\left(x_i\right)f_k\left(x_i\right)\right)}\right)}\right. &amp;= \sum_{i=0}^{n}{\left(y_if_k\left(x_i\right)\right)}
\end{align*}\]</span></p>
</div>
</div><div class="column" style="width:5%;">
<div style="height:100%; border-right:3px solid #444;">

</div>
</div><div class="column" style="width:5%;">
<div style="height:100%; border-left:3px solid #444;">

</div>
</div><div class="column" style="width:45%;">

</div>
</div>
</section>
<section id="minimizing-the-loss-4" class="slide level2">
<h2>Minimizing the Loss</h2>
<div style="font-size:18pt">
<p>As a reminder, we are minimizing</p>
</div>
<div style="font-size:16pt">
<p><span class="math display">\[\left\{\frac{\partial L}{\partial \beta_k} = -2\left(\sum_{i=0}^{n}{\left(\left(y_i - \sum_{j = 0}^{m}{\left(\beta_j f_j\left(x_i\right)\right)}\right)f_k\left(x_i\right)\right)}\right) = 0\right.~~\text{for}~~k = 0, 1, \cdots, m\]</span></p>
</div>
<div style="font-size:18pt">
<p>We can divide both sides of each equation in the system by <span class="math inline">\(-2\)</span> and rearrange the summations.</p>
</div>
<div class="columns">
<div class="column" style="width:45%;">
<div style="font-size:16pt">
<p><span class="math display">\[\begin{align*}\left\{\left(\sum_{i=0}^{n}{\left(\left(y_i - \sum_{j = 0}^{m}{\left(\beta_j f_j\left(x_i\right)\right)}\right)f_k\left(x_i\right)\right)}\right)\right. &amp;= 0\\
\implies \left\{\sum_{i=0}^{n}{\left(y_if_k\left(x_i\right) - \sum_{j = 0}^{m}{\left(\beta_j f_j\left(x_i\right)f_k\left(x_i\right)\right)}\right)}\right. &amp;= 0\\
\implies \left\{\sum_{i=0}^{n}{\left(y_if_k\left(x_i\right)\right)} - \sum_{i=0}^{n}{\left(\sum_{j = 0}^{m}{\left(\beta_j f_j\left(x_i\right)f_k\left(x_i\right)\right)}\right)}\right. &amp;= 0\\
\implies \left\{\sum_{i=0}^{n}{\left(\sum_{j = 0}^{m}{\left(\beta_j f_j\left(x_i\right)f_k\left(x_i\right)\right)}\right)}\right. &amp;= \sum_{i=0}^{n}{\left(y_if_k\left(x_i\right)\right)}
\end{align*}\]</span></p>
</div>
</div><div class="column" style="width:5%;">
<div style="height:100%; border-right:3px solid #444;">

</div>
</div><div class="column" style="width:5%;">
<div style="height:100%; border-left:3px solid #444;">

</div>
</div><div class="column" style="width:45%;">
<div style="font-size:16pt">
<p><span class="math display">\[\begin{align*}
\implies \left\{\sum_{j=0}^{m}{\left(\sum_{i = 0}^{n}{\left(\beta_j f_j\left(x_i\right)f_k\left(x_i\right)\right)}\right)}\right. &amp;= \sum_{i=0}^{n}{\left(y_if_k\left(x_i\right)\right)}
\end{align*}\]</span></p>
</div>
</div>
</div>
</section>
<section id="minimizing-the-loss-5" class="slide level2">
<h2>Minimizing the Loss</h2>
<div style="font-size:18pt">
<p>As a reminder, we are minimizing</p>
</div>
<div style="font-size:16pt">
<p><span class="math display">\[\left\{\frac{\partial L}{\partial \beta_k} = -2\left(\sum_{i=0}^{n}{\left(\left(y_i - \sum_{j = 0}^{m}{\left(\beta_j f_j\left(x_i\right)\right)}\right)f_k\left(x_i\right)\right)}\right) = 0\right.~~\text{for}~~k = 0, 1, \cdots, m\]</span></p>
</div>
<div style="font-size:18pt">
<p>We can divide both sides of each equation in the system by <span class="math inline">\(-2\)</span> and rearrange the summations.</p>
</div>
<div class="columns">
<div class="column" style="width:45%;">
<div style="font-size:16pt">
<p><span class="math display">\[\begin{align*}\left\{\left(\sum_{i=0}^{n}{\left(\left(y_i - \sum_{j = 0}^{m}{\left(\beta_j f_j\left(x_i\right)\right)}\right)f_k\left(x_i\right)\right)}\right)\right. &amp;= 0\\
\implies \left\{\sum_{i=0}^{n}{\left(y_if_k\left(x_i\right) - \sum_{j = 0}^{m}{\left(\beta_j f_j\left(x_i\right)f_k\left(x_i\right)\right)}\right)}\right. &amp;= 0\\
\implies \left\{\sum_{i=0}^{n}{\left(y_if_k\left(x_i\right)\right)} - \sum_{i=0}^{n}{\left(\sum_{j = 0}^{m}{\left(\beta_j f_j\left(x_i\right)f_k\left(x_i\right)\right)}\right)}\right. &amp;= 0\\
\implies \left\{\sum_{i=0}^{n}{\left(\sum_{j = 0}^{m}{\left(\beta_j f_j\left(x_i\right)f_k\left(x_i\right)\right)}\right)}\right. &amp;= \sum_{i=0}^{n}{\left(y_if_k\left(x_i\right)\right)}
\end{align*}\]</span></p>
</div>
</div><div class="column" style="width:5%;">
<div style="height:100%; border-right:3px solid #444;">

</div>
</div><div class="column" style="width:5%;">
<div style="height:100%; border-left:3px solid #444;">

</div>
</div><div class="column" style="width:45%;">
<div style="font-size:16pt">
<p><span class="math display">\[\begin{align*}
\implies \left\{\sum_{j=0}^{m}{\left(\sum_{i = 0}^{n}{\left(\beta_j f_j\left(x_i\right)f_k\left(x_i\right)\right)}\right)}\right. &amp;= \sum_{i=0}^{n}{\left(y_if_k\left(x_i\right)\right)}\\
\implies \left\{\sum_{j=0}^{m}{\left(\sum_{i = 0}^{n}{\left(f_j\left(x_i\right)f_k\left(x_i\right)\right)\beta_j}\right)}\right. &amp;= \sum_{i=0}^{n}{\left(f_k\left(x_i\right)y_i\right)}~~\text{for}~~k = 0, 1, \cdots, m\\
\end{align*}\]</span></p>
</div>
</div>
</div>
</section>
<section id="minimizing-the-loss-6" class="slide level2">
<h2>Minimizing the Loss</h2>
<div class="columns">
<div class="column" style="width:45%;">
<div style="font-size:16pt">
<p><span class="math display">\[\begin{align*}\left\{\left(\sum_{i=0}^{n}{\left(\left(y_i - \sum_{j = 0}^{m}{\left(\beta_j f_j\left(x_i\right)\right)}\right)f_k\left(x_i\right)\right)}\right)\right. &amp;= 0\\
\implies \left\{\sum_{i=0}^{n}{\left(y_if_k\left(x_i\right) - \sum_{j = 0}^{m}{\left(\beta_j f_j\left(x_i\right)f_k\left(x_i\right)\right)}\right)}\right. &amp;= 0\\
\implies \left\{\sum_{i=0}^{n}{\left(y_if_k\left(x_i\right)\right)} - \sum_{i=0}^{n}{\left(\sum_{j = 0}^{m}{\left(\beta_j f_j\left(x_i\right)f_k\left(x_i\right)\right)}\right)}\right. &amp;= 0\\
\implies \left\{\sum_{i=0}^{n}{\left(\sum_{j = 0}^{m}{\left(\beta_j f_j\left(x_i\right)f_k\left(x_i\right)\right)}\right)}\right. &amp;= \sum_{i=0}^{n}{\left(y_if_k\left(x_i\right)\right)}
\end{align*}\]</span></p>
</div>
</div><div class="column" style="width:5%;">
<div style="height:100%; border-right:3px solid #444;">

</div>
</div><div class="column" style="width:5%;">
<div style="height:100%; border-left:3px solid #444;">

</div>
</div><div class="column" style="width:45%;">
<div style="font-size:16pt">
<p><span class="math display">\[\begin{align*}
\implies \left\{\sum_{j=0}^{m}{\left(\sum_{i = 0}^{n}{\left(\beta_j f_j\left(x_i\right)f_k\left(x_i\right)\right)}\right)}\right. &amp;= \sum_{i=0}^{n}{\left(y_if_k\left(x_i\right)\right)}\\
\implies \left\{\sum_{j=0}^{m}{\left(\sum_{i = 0}^{n}{\left(f_j\left(x_i\right)f_k\left(x_i\right)\right)\beta_j}\right)}\right. &amp;= \sum_{i=0}^{n}{\left(f_k\left(x_i\right)y_i\right)}~~\text{for}~~k = 0, 1, \cdots, m\\
\end{align*}\]</span></p>
</div>
</div>
</div>
<div class="fragment">
<div style="font-size:18pt">
<p>We can rewrite the above using matrix notation as <span class="math inline">\(A\vec{\beta} = \vec{b}\)</span>, where</p>
</div>
<div style="font-size:16pt">
<p><span class="math display">\[A_{kj} = \sum_{i = 0}^{n}{f_j\left(x_i\right)f_k\left(x_i\right)}~~~~\text{and}~~~~b_k = \sum_{i=0}^{n}{f_k\left(x_i\right)y_i}\]</span></p>
</div>
</div>
<div class="fragment">
<div style="font-size:18pt">
<p>These equations are known as the <em>normal equations</em> of the least-squares fit, and can be solved using our numerical methods for solving [symmetric] linear systems!</p>
</div>
</div>
</section>
<section id="polynomial-fit" class="slide level2">
<h2>Polynomial Fit</h2>
<div style="font-size:18pt">
<p>We can rewrite the above using matrix notation as <span class="math inline">\(A\vec{\beta} = \vec{b}\)</span>, where</p>
</div>
<div style="font-size:16pt">
<p><span class="math display">\[A_{kj} = \sum_{i = 0}^{n}{f_j\left(x_i\right)f_k\left(x_i\right)}~~~~\text{and}~~~~b_k = \sum_{i=0}^{n}{f_k\left(x_i\right)y_i}\]</span></p>
</div>
<div style="font-size:18pt">
<p>These equations are known as the <em>normal equations</em> of the least-squares fit, and can be solved using our numerical methods for solving [symmetric] linear systems!</p>
</div>
<div style="font-size:18pt">
<div class="fragment">
<p>As mentioned earlier, a commonly used linear form is a polynomial.</p>
</div>
<div class="fragment">
<p>In this case, the basis functions are <span class="math inline">\(f_j\left(x\right) = x^j\)</span>.</p>
</div>
<div class="fragment">
<p>This leads to the following <span class="math inline">\(A\)</span> and <span class="math inline">\(\vec{b}\)</span> from the normal equations above:</p>
<p><span class="math display">\[A_{kj} = \sum_{i = 0}^{n}{x_i^{j+k}}~~~~\text{and}~~~~b_k = \sum_{i=0}^{n}{x_i^ky_i}\]</span></p>
</div>
<div class="fragment">
<p>The coefficient matrix <span class="math inline">\(A\)</span> becomes increasingly ill-conditioned as <span class="math inline">\(m\)</span> is made larger.</p>
</div>
<div class="fragment">
<p>Luckily, high-degree polynomials are typically not used in curve-fitting since they are very susceptible to fitting the noise in the observed data.</p>
</div>
</div>
</section>
<section id="polynomial-least-squares-algorithm" class="slide level2">
<h2>Polynomial Least Squares Algorithm</h2>
<div style="font-size:18pt">
<div class="fragment">
<p>With all of that math understood, we are ready to construct a routine to fit least-squares polynomial models.</p>
</div>
<div class="fragment">
<p>Since we need to solve symmetric linear systems as part of solving the normal equations, we’ll need access to functionality from earlier in our course.</p>
</div>
<div class="fragment">
<p>As a reminder, you make this older functionality available in a new notebook by pasting it into a code cell at the top of your notebook and running that code cell.</p>
</div>
<div class="fragment">
<p>Because observed data can come in any order, we should be worried about when to <em>pivot</em> as we solve our linear system. For this reason, we’ll bring in the <code>swapRows()</code>, <code>scaleFactors()</code>, and <code>gaussPivot()</code> functions from our Day 7 dicussion.</p>
</div>
<div class="fragment">
<p>I’ve already enabled them in this slide deck, for convenience. I won’t show the pasting here.</p>
</div>
</div>
</section>
<section id="polynomial-least-squares-algorithm-1" class="slide level2">
<h2>Polynomial Least Squares Algorithm</h2>
<div style="font-size:18pt">
<div class="columns">
<div class="column" style="width:50%;">
<div class="fragment">
<p>With those earlier functions available to us, we’ll write our <code>polyFit()</code> routine.</p>
</div>
<div class="fragment">
<p>This routine will return the coefficients of a linear model of the form</p>
<p><span class="math display">\[f\left(x\right) = \beta_0 + \beta_1 x + \beta_2 x^2 + \cdots + \beta_m x^m\]</span></p>
<p>fit on training data of the form <span class="math inline">\(\left(x_i, y_i\right)\)</span> with <code>xData</code> holding the <span class="math inline">\(x_i\)</span> values an <code>yData</code> holding the <span class="math inline">\(y_i\)</span> values.</p>
</div>
<div class="fragment">
<p>The function will take one additional parameter, <code>m</code>, which is the degree of the polynomial model.</p>
</div>
</div><div class="column" style="width:50%;">
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href=""></a><span class="kw">def</span> polyFit(xData, yData, m):</span>
<span id="cb1-2"><a href=""></a>  A <span class="op">=</span> np.zeros((m<span class="op">+</span><span class="dv">1</span>, m<span class="op">+</span><span class="dv">1</span>))</span>
<span id="cb1-3"><a href=""></a>  b <span class="op">=</span> np.zeros(m<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb1-4"><a href=""></a>  s <span class="op">=</span> np.zeros(<span class="dv">2</span><span class="op">*</span>m<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb1-5"><a href=""></a></span>
<span id="cb1-6"><a href=""></a>  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(xData)):</span>
<span id="cb1-7"><a href=""></a>    temp <span class="op">=</span> yData[i]</span>
<span id="cb1-8"><a href=""></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(m<span class="op">+</span><span class="dv">1</span>):</span>
<span id="cb1-9"><a href=""></a>      b[j] <span class="op">=</span> b[j] <span class="op">+</span> temp</span>
<span id="cb1-10"><a href=""></a>      temp <span class="op">=</span> temp<span class="op">*</span>xData[i]</span>
<span id="cb1-11"><a href=""></a></span>
<span id="cb1-12"><a href=""></a>    temp <span class="op">=</span> <span class="fl">1.0</span></span>
<span id="cb1-13"><a href=""></a></span>
<span id="cb1-14"><a href=""></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span><span class="op">*</span>m <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb1-15"><a href=""></a>      s[j] <span class="op">=</span> s[j] <span class="op">+</span> temp</span>
<span id="cb1-16"><a href=""></a>      temp <span class="op">=</span> temp<span class="op">*</span>xData[i]</span>
<span id="cb1-17"><a href=""></a></span>
<span id="cb1-18"><a href=""></a>  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(m<span class="op">+</span><span class="dv">1</span>):</span>
<span id="cb1-19"><a href=""></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(m<span class="op">+</span><span class="dv">1</span>):</span>
<span id="cb1-20"><a href=""></a>      A[i, j] <span class="op">=</span> s[i <span class="op">+</span> j]</span>
<span id="cb1-21"><a href=""></a></span>
<span id="cb1-22"><a href=""></a>  <span class="cf">return</span> gaussPivot(A, b)</span>
<span id="cb1-23"><a href=""></a></span>
<span id="cb1-24"><a href=""></a><span class="kw">def</span> evalPoly(coefs, x):</span>
<span id="cb1-25"><a href=""></a>  m <span class="op">=</span> <span class="bu">len</span>(coefs) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb1-26"><a href=""></a>  p <span class="op">=</span> coefs[m]</span>
<span id="cb1-27"><a href=""></a>  <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(m):</span>
<span id="cb1-28"><a href=""></a>    p <span class="op">=</span> p<span class="op">*</span>x <span class="op">+</span> coefs[m <span class="op">-</span> j <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb1-29"><a href=""></a></span>
<span id="cb1-30"><a href=""></a>  <span class="cf">return</span> p</span>
<span id="cb1-31"><a href=""></a></span>
<span id="cb1-32"><a href=""></a><span class="kw">def</span> getStdError(xData, yData, coefs):</span>
<span id="cb1-33"><a href=""></a>  n <span class="op">=</span> <span class="bu">len</span>(xData)</span>
<span id="cb1-34"><a href=""></a>  m <span class="op">=</span> <span class="bu">len</span>(coefs)</span>
<span id="cb1-35"><a href=""></a>  sse <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb1-36"><a href=""></a>  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb1-37"><a href=""></a>    y_hat <span class="op">=</span> evalPoly(coefs, xData[i])</span>
<span id="cb1-38"><a href=""></a>    resid <span class="op">=</span> yData[i] <span class="op">-</span> y_hat</span>
<span id="cb1-39"><a href=""></a>    sse <span class="op">=</span> sse <span class="op">+</span> resid<span class="op">**</span><span class="dv">2</span></span>
<span id="cb1-40"><a href=""></a></span>
<span id="cb1-41"><a href=""></a>  stdError <span class="op">=</span> (sse<span class="op">/</span>(n <span class="op">-</span> m))<span class="op">**</span><span class="fl">0.5</span></span>
<span id="cb1-42"><a href=""></a>  <span class="cf">return</span> stdError</span>
<span id="cb1-43"><a href=""></a></span>
<span id="cb1-44"><a href=""></a><span class="kw">def</span> plotPoly(xData, yData, coefs, num_pts <span class="op">=</span> <span class="dv">100</span>, xlab <span class="op">=</span> <span class="st">"x"</span>, ylab <span class="op">=</span> <span class="st">"y"</span>):</span>
<span id="cb1-45"><a href=""></a>  m <span class="op">=</span> <span class="bu">len</span>(coefs)</span>
<span id="cb1-46"><a href=""></a>  x1 <span class="op">=</span> <span class="bu">min</span>(xData)</span>
<span id="cb1-47"><a href=""></a>  x2 <span class="op">=</span> <span class="bu">max</span>(xData)</span>
<span id="cb1-48"><a href=""></a>  x_new <span class="op">=</span> np.linspace(x1, x2, num_pts)</span>
<span id="cb1-49"><a href=""></a>  y_new <span class="op">=</span> np.zeros(<span class="bu">len</span>(x_new))</span>
<span id="cb1-50"><a href=""></a></span>
<span id="cb1-51"><a href=""></a>  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_pts):</span>
<span id="cb1-52"><a href=""></a>    y_new[i] <span class="op">=</span> evalPoly(coefs, x_new[i])</span>
<span id="cb1-53"><a href=""></a></span>
<span id="cb1-54"><a href=""></a>  plt.scatter(xData, yData, color <span class="op">=</span> <span class="st">"black"</span>, s <span class="op">=</span> <span class="dv">150</span>)</span>
<span id="cb1-55"><a href=""></a>  plt.plot(x_new, y_new, color <span class="op">=</span> <span class="st">"purple"</span>, linewidth <span class="op">=</span> <span class="dv">3</span>)</span>
<span id="cb1-56"><a href=""></a>  plt.grid()</span>
<span id="cb1-57"><a href=""></a>  plt.axhline(color <span class="op">=</span> <span class="st">"black"</span>)</span>
<span id="cb1-58"><a href=""></a>  plt.axvline(color <span class="op">=</span> <span class="st">"black"</span>)</span>
<span id="cb1-59"><a href=""></a>  plt.xlabel(xlab)</span>
<span id="cb1-60"><a href=""></a>  plt.ylabel(ylab)</span>
<span id="cb1-61"><a href=""></a>  plt.title(<span class="st">"A Polynomial Least Squares Fit of Degree "</span> <span class="op">+</span> <span class="bu">str</span>(m <span class="op">-</span> <span class="dv">1</span>), fontsize <span class="op">=</span> <span class="dv">20</span>)</span>
<span id="cb1-62"><a href=""></a>  plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="comments-on-the-functionality" class="slide level2">
<h2>Comments on the Functionality</h2>
<div class="fragment">
<p>The previous slide gave your four new functions that are useful for least squares regression (curve fitting) applications. You’ll directly use all of them.</p>
</div>
<ul>
<li class="fragment">The <code>polyFit()</code> function takes in the observed data and the desired degree of the polynomial model and returns the fitted coefficients as solutions to the normal equations.</li>
<li class="fragment">The <code>evalPoly()</code> function allows you to evaluate your fitted polynomial for new observations. That is, this is the function that allows you to make predictions.</li>
<li class="fragment">The <code>getStdError()</code> function computes the standard error of residuals. This is a measure of model performance. Smaller indicates a better fit, but you should be guided by held out test data here rather than reusing your training data. Take MAT300 to find out why.</li>
<li class="fragment">The <code>plotPoly()</code> function is a convenience function that will handle plotting your training data and fitted polynomial model for you.</li>
</ul>
</section>
<section id="example-usage" class="slide level2">
<h2>Example Usage</h2>
<div class="fragment">
<div class="columns">
<div class="column" style="width:70%;">
<div style="font-size:20pt">
<p><strong>Example:</strong> Fit a second-order (quadratic) linear regression model to the observed data on the right.</p>
</div>
</div><div class="column" style="width:30%;">
<div style="font-size:16pt">
<table class="caption-top">
<thead>
<tr class="header">
<th><span class="math inline">\(x\)</span></th>
<th><span class="math inline">\(y\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>4</td>
<td>-4.35</td>
</tr>
<tr class="even">
<td>10</td>
<td>29.15</td>
</tr>
<tr class="odd">
<td>0</td>
<td>31.64</td>
</tr>
<tr class="even">
<td>9</td>
<td>37.23</td>
</tr>
<tr class="odd">
<td>6</td>
<td>12.27</td>
</tr>
<tr class="even">
<td>5</td>
<td>8.20</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="fragment">
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href=""></a>xData <span class="op">=</span> np.array([<span class="fl">4.0</span>, <span class="dv">10</span>, <span class="dv">0</span>, <span class="dv">9</span>, <span class="dv">6</span>, <span class="dv">5</span>])</span>
<span id="cb2-2"><a href=""></a>yData <span class="op">=</span> np.array([<span class="op">-</span><span class="fl">4.35</span>, <span class="fl">29.15</span>, <span class="fl">31.64</span>, <span class="fl">37.23</span>, <span class="fl">12.27</span>, <span class="fl">8.2</span>])</span>
<span id="cb2-3"><a href=""></a></span>
<span id="cb2-4"><a href=""></a>coefs <span class="op">=</span> polyFit(xData, yData, <span class="dv">2</span>)</span>
<span id="cb2-5"><a href=""></a>se <span class="op">=</span> getStdError(xData, yData, coefs)</span>
<span id="cb2-6"><a href=""></a></span>
<span id="cb2-7"><a href=""></a><span class="bu">print</span>(<span class="st">"The model standard error is: "</span>, se)</span>
<span id="cb2-8"><a href=""></a>plotPoly(xData, yData, coefs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>The model standard error is:  10.330611126284781</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="D11_LeastSquares_files/figure-revealjs/unnamed-chunk-7-5.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="summary" class="slide level2">
<h2>Summary</h2>
<ul>
<li class="fragment">In this discussion we saw how to fit a curve to data using the method of <em>Ordinary Least Squares</em>.</li>
<li class="fragment">In particular, we worked with polynomial models, but we developed the general form of the <em>normal equations</em> for least squares which apply for any model which is a linear combination of <em>basis functions</em> <span class="math inline">\(f_i\left(x\right)\)</span>.</li>
<li class="fragment">Finally, we wrote a routine that will fit a polynomial model of desired degree to observed data and included some helper functions to evaluate and plot the polynomial.</li>
</ul>
</section>
<section id="next-time" class="slide level2">
<h2>Next Time</h2>
<p><br> <br></p>
<p>We’ll pause here to encounter our first <em>Unit Problem Set</em>. This means that you’ll spend the next week working through several interesting applications which can be addressed using one or more of the methods we’ve encountered so far in our course.</p>
</section>
<section id="owed-algebra" class="slide level2">
<h2>Owed Algebra</h2>
<div style="font-size:16pt">
<p>Earlier in this notebook it was suggested that, after a bit of algebra, we could obtain <span class="math inline">\(\displaystyle{\beta_1 = \frac{\sum{y_i\left(x_i - \bar{x}\right)}}{\sum{x_i\left(x_i - \bar{x}\right)}}}\)</span>. The algebra required for that appears below. Recall that we have <span class="math inline">\(\beta_0 = \bar{y} - \beta_1\bar{x}\)</span>. From here we have</p>
</div>
<div style="font-size:14pt">
<p><span class="math display">\[\begin{align*} -\beta_0\bar{x} + \sum{\left(\frac{x_iy_i}{n+1} - \frac{\beta_1x_i^2}{n+1}\right)} &amp;= 0\\
\implies -\left(\bar{y} - \beta_1 \bar{x}\right)\bar{x} + \sum{\left(\frac{x_iy_i}{n+1} - \frac{\beta_1x_i^2}{n+1}\right)} &amp;= 0\\
\implies -\bar{x}\bar{y} + \beta_1\bar{x}^2 + \sum{\frac{x_iy_i}{n+1}} - \beta_1\sum{\frac{x_i^2}{n+1}} &amp;= 0\\
\implies \beta_1\sum{\frac{x_i^2}{n+1}} - \beta_1\bar{x}^2  &amp;= \sum{\frac{x_iy_i}{n+1}} - \bar{x}\bar{y} \\
\implies \beta_1\left(\sum{\frac{x_i^2}{n+1}} - \left(\sum{\frac{x_i}{n+1}}\right)^2\right) &amp;= \sum{\frac{x_iy_i}{n+1}} - \left(\sum{\frac{x_i}{n+1}}\right)\left(\sum{\frac{y_i}{n+1}}\right)\\
\implies \beta_1\left(\sum{\frac{x_i^2}{n+1}} - \left(\sum{\frac{x_i}{n+1}}\right)\left(\sum{\frac{x_i}{n+1}}\right)\right) &amp;= \sum{\frac{x_iy_i}{n+1}} - \left(\sum{\frac{x_i}{n+1}}\right)\left(\sum{\frac{y_i}{n+1}}\right)\\
\implies \beta_1\left(\sum{\left(\frac{x_i}{n+1}\left(x_i - \sum{\frac{x_i}{n+1}}\right)\right)}\right) &amp;= \sum{\left(\frac{y_i}{n+1}\left(x_i - \sum{\frac{x_i}{n+1}}\right)\right)}\\
\implies \beta_1\sum{\left(\frac{x_i}{n+1}\left(x_i - \bar{x}\right)\right)} &amp;= \sum{\left(\frac{y_i}{n+1}\left(x_i - \bar{x}\right)\right)}\\
\implies \beta_1\sum{x_i\left(x_i - \bar{x}\right)} &amp;= \sum{y_i\left(x_i - \bar{x}\right)}\\
\implies \beta_1 &amp;= \frac{\sum{y_i\left(x_i - \bar{x}\right)}}{\sum{x_i\left(x_i - \bar{x}\right)}}~~\checkmark
\end{align*}\]</span></p>
</div>
<div class="quarto-auto-generated-content">
<div class="footer footer-default">

</div>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="D11_LeastSquares_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="D11_LeastSquares_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="D11_LeastSquares_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="D11_LeastSquares_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="D11_LeastSquares_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="D11_LeastSquares_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="D11_LeastSquares_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="D11_LeastSquares_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="D11_LeastSquares_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="D11_LeastSquares_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': true,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        // For code content inside modals, clipBoardJS needs to be initialized with a container option
        // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>